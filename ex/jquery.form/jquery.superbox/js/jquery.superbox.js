(function(a){function C(){a("a[rel^=superbox],area[rel^=superbox]").each(function(){var c=a(this),b=c.attr("rel"),d=b.match(/^superbox\[([^#\.\]]+)/)[1],e=b.replace("superbox","").match(/([#\.][^#\.\]]+)/g)||[],k=g.boxId,f=g.boxClasses;this._relSettings=b.replace("superbox["+d+e.join("")+"]","");a.each(e,function(b,a){"#"==a.substr(0,1)?k=a.substr(1):"."==a.substr(0,1)&&(f+=" "+a.substr(1))});-1!=d.search(/^image|gallery|iframe|content|ajax$/)&&c.superbox(d,{boxId:k,boxClasses:f})})}function l(a){return a._relSettings.match(/([^\[\]]+)/g)}
function D(a,b){m.show();y=!0;var d=a.get(0)._superboxGroupKey+1,e=d-2;h[b][d]?n.removeClass("disabled").unbind("click").bind("click",function(){h[b][d].click()}):n.addClass("disabled").unbind("click");h[b][e]?p.removeClass("disabled").unbind("click").bind("click",function(){h[b][e].click()}):p.addClass("disabled").unbind("click")}function r(a){$superbox.attr("id",a.boxId).attr("class",a.boxClasses)}function z(c){a(document).unbind("keydown");t.hide();m.hide();f.hide().css({position:"fixed",top:0});
$innerbox.empty();q.fadeOut(300,function(){u.show()});y=!1}function v(c){var b=function(){a.browser.msie&&7>a.browser.version&&f.css({position:"absolute",top:"50%"});u.hide();t.show();c()};y?(q.css("opacity",g.overlayOpacity).show(),b()):q.css("opacity",0).show().fadeTo(300,g.overlayOpacity,b)}function w(){f.show();$innerbox.empty();$superbox.css({position:"absolute",top:"-99999px"})}function x(c,b){t.hide();a(document).unbind("keydown").bind("keydown",function(a){27==a.keyCode&&z();39==a.keyCode&&
n.is(":visible")&&n.click();37==a.keyCode&&p.is(":visible")&&p.click()});$superbox.css({position:"static",top:0,opacity:0});a.browser.msie&&8>a.browser.version&&($superbox.css({position:"relative",top:"-50%"}),a.browser.msie&&7>a.browser.version&&f.css({position:"absolute",top:"50%"}));a(window).height()<f.height()&&f.css({position:"absolute",top:f.offset().top+10+"px"});g.beforeShow();$superbox.fadeTo("300",1,function(){a("#[id^='"+g.closeButtonId+"']").bind("click",function(){z()});g.afterShow()})}
function E(){a.superbox.elementsReady||(q=a('<div id="superbox-overlay"></div>').appendTo("body").hide(),f=a('<div id="superbox-wrapper"></div>').appendTo("body").hide(),A=a('<div id="superbox-container"></div>').appendTo(f),$superbox=a('<div id="superbox"></div>').appendTo(A),$innerbox=a('<div id="superbox-innerbox"></div>').appendTo($superbox),m=a('<p class="nextprev"></p>').appendTo($superbox).hide(),p=a('<a class="prev"><strong><span>'+g.prevTxt+"</span></strong></a>").appendTo(m),n=a('<a class="next"><strong><span>'+
g.nextTxt+"</span></strong></a>").appendTo(m),B=a('<p class="close"><a><strong><span>'+g.closeTxt+"</span></strong></a></p>").prependTo($innerbox).find("a"),t=a('<p class="loading">'+g.loadTxt+"</p>").appendTo(A).hide(),q.add(f).add(B).click(function(){z()}),$superbox.click(function(a){a.stopPropagation()}),a.superbox.elementsReady=!0)}var q,f,A,$superbox,B,t,m,n,p,g,F={boxId:"superbox",boxClasses:"",overlayOpacity:.8,boxWidth:"600",boxHeight:"400",loadTxt:"Loading...",closeButtonId:"closeSuperBoxButtonId",
closeTxt:"Close",prevTxt:"Previous",nextTxt:"Next",beforeShow:function(){},afterShow:function(){}},h={},y=!1,u=a([]);a.superbox=function(){g=a.extend({},F,a.superbox.settings);a.browser.msie&&7>a.browser.version&&(u=u.add("select"));E();C()};a.fn.superbox=function(c,b){b=a.extend({},g,b);a.superbox[c](this,b)};a.extend(a.superbox,{image:function(c,b,d){var e=l(c.get(0)),k=!1;e&&"gallery"==d?k=e[1]:e&&(k=e[0]);c.click(function(f){f.preventDefault();w();"gallery"==d&&D(c,e[0]);v(function(){var d=!1,
e;k&&(d=k.split("x"));e=a('<img src="'+c.attr("href")+'" title="'+(c.attr("title")||c.text())+'" />');e.load(function(){var a=d;$superbox.width(e.width()+($innerbox.css("paddingLeft").slice(0,-2)-0)+($innerbox.css("paddingRight").slice(0,-2)-0));$innerbox.height(e.height());a&&""!=a[0]&&$superbox.width(a[0]+"px");a&&""!=a[1]&&a[1]>e.height()&&$innerbox.height(a[1]+"px");r({boxClasses:"image "+b.boxClasses,boxId:b.boxId});x()}).appendTo($innerbox)})})},gallery:function(c,b){var d=l(c.get(0));h[d[0]]||
(h[d[0]]=[]);h[d[0]].push(c);c.get(0)._superboxGroupKey=h[d[0]].length-1;a.superbox.image(c,b,"gallery")},iframe:function(c,b){var d=l(c.get(0));c.click(function(e){e.preventDefault();w();v(function(){var e=!1;d&&(e=d[0].split("x"));b=a.extend({},b,{boxWidth:e[0]||b.boxWidth,boxHeight:e[1]||b.boxHeight});a('<iframe src="'+c.attr("href")+'" name="'+c.attr("href")+'" frameborder="0" scrolling="auto" hspace="0" width="'+b.boxWidth+'" height="'+b.boxHeight+'"></iframe>').load(function(){$superbox.width(b.boxWidth+
"px");$innerbox.height(b.boxHeight+"px");r({boxClasses:"iframe "+b.boxClasses,boxId:b.boxId});x()}).appendTo($innerbox)})})},content:function(c,b){var d=l(c.get(0));c.click(function(e){e.preventDefault();w();v(function(){var e=!1;d&&(e=d[0].split("x"));b=a.extend({},b,{boxWidth:e[0]||b.boxWidth,boxHeight:e[1]||b.boxHeight});$superbox.width(b.boxWidth+"px");$innerbox.height(b.boxHeight+"px");a(c.attr("href")).clone().appendTo($innerbox).show();r({boxClasses:"content "+b.boxClasses,boxId:b.boxId});
x()})})},ajax:function(c,b){var d=l(c.get(0));c.click(function(c){c.preventDefault();w();v(function(){var c=!1;d&&d[3]&&(c=d[3].split("x"));b=a.extend({},b,{boxWidth:c[0]||b.boxWidth,boxHeight:c[1]||b.boxHeight});$superbox.width(b.boxWidth+"px");$innerbox.height(b.boxHeight+"px");a.get(d[2],function(b){a(b).appendTo($innerbox)});r({boxClasses:"ajax "+b.boxClasses,boxId:b.boxId});x()})})}})})(jQuery);
